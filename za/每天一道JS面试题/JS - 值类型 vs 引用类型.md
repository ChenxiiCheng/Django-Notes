## JS - 值类型 vs 引用类型

### 1. 值类型(基本类型)和引用类型的区别？

**总结：值类型：**变量把自身的一个副本传递给新变量之后，就再也和它没关系了，之后在新变量上进行的操作不会改变旧变量； **引用类型：**变量把自身指向的内存地址传递给新变量，之后在新变量上进行的操作会改变旧变量，因为它们都指向同一个内存地址【新变量上的操作改变了那个内存地址里的东西】

**值类型和引用类型存储于内容的位置不同：**

- 值类型直接存储在 **栈** 中
- 引用类型的对象存储在 **堆** 中，同时在 **栈** 中存储了指针，这个指针指向的正是 **堆** 中实体的起始位置

1. **值类型：**`boolean`、`string`、`number`、`undefined`、`null`

2. **引用类型：**`function`、`object`、`array`    【数组、对象、函数】

3. 在参数传递方式上，值类型是按值传递，引用类型是按共享传递

   ```javascript
   //1.值类型
   //赋值的时候，其实是把自己的一个副本赋值给新的变量，所以副本之后再怎么变化与原体无关
   var a = 10;
   var b = a;
   b = 20;
   console.log(a);    // 10
   console.log(b);    // 20
   ```

   ```javascript
   //2.引用类型
   //赋值的时候，其实是把自己指的内存地址赋值给了新的变量，所以新变量和旧变量指向的是同一个内存地址，因此新变量上做的变换，实际改变的是那个内存地址上的东西，所以旧变量也会变
   //下面的代码中, a b都是引用类型。在执行了b = a之后，修改b的属性值，a的属性值也跟着变化。因为a和b都是引用类型，指向了同一个内存地址，即两者引用的都是同一个值，因此b修改属性时，a的值也随之改动
   var a = {x: 10, y: 20};
   var b = a;
   b.x = 100;
   b.y = 200;
   console.log(a);    // {x: 100, y: 200}
   console.log(b);    // {x: 100, y: 200}
   
   function test(person) {
     person.age = 26;
     person = {
       name: 'chenxi',
       age: 23
     }
     return person;
   }
   
   const p1 = {
     name: 'chenxi',
     age: 30
   }
   const p2 = test(p1);
   console.log(p1);          // 'chenxi', 26
   console.log(p2);          // 'chenxi', 23
   ```

   ```javascript
   //值类型+引用类型
   function foo(a) {    
     a = a * 10;
   }
   function bar(b) {
     b.value = 'new';
   }
   var a = 1;         
   var b = {value: 'old'}; 
   foo(a);     // 值类型按值传递，当值类型调用函数的时候，只是传递自己的副本进去
   bar(b);     // 引用类型按共享传递，当引用类型调用函数时候，把指向的内存地址传进去了
   console.log(a);    // 1
   console.log(b);    // {value: 'new'}
   ```

   ```javascript
   //经典的值类型、引用类型考题
   //obj内部的a和b一个是值类型一个是引用类型，a的赋值不会改变obj.a，但是b的操作却会反映到obj.b上
   var obj = {
     a: 1;            //值类型
     b: [1, 2, 3];    //引用类型
   }
   var c = obj.a;     //值类型的变量传递一个副本给新变量而已
   var b = obj.b;     //引用类型的变量，把自己所指向的内存地址传递给了新变量
   c = 2;     //var c = obj.c => c=1; 然后给c赋了新值 => c = 2
   b.push(4);
   console.log(obj, c, b)   // c: 2, b: [1, 2, 3, 4]
   ```

   

4. **JavaScript中这种设计的原因是：**

   1. 按值传递的类型，复制一份存入栈内存，这类类型一般不占用太多内存，而且按值传递保证了其访问速度。
   2. 按共享传递的类型，是复制其引用，而不是整个复制其值，保证过大的对象不会因为不停复制内容而造成内存的浪费。